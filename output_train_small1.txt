2021-03-22 17:01:52.374087: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 3800000000 Hz
2021-03-22 17:01:52.375109: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f9f1f73db0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-03-22 17:01:52.375138: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-03-22 17:01:52.415105: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-03-22 17:01:52.595372: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f9f1f719c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-03-22 17:01:52.595414: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 SUPER, Compute Capability 7.5
2021-03-22 17:01:52.595926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-03-22 17:01:52.636905: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-03-22 17:01:52.681014: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-03-22 17:01:52.689944: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-03-22 17:01:52.745412: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-03-22 17:01:52.782894: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-03-22 17:01:52.852218: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-03-22 17:01:52.874504: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-03-22 17:01:52.875253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-03-22 17:01:52.875307: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-03-22 17:01:52.876268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-22 17:01:52.876281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 
2021-03-22 17:01:52.876287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N 
2021-03-22 17:01:52.876937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7184 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 SUPER, pci bus id: 0000:65:00.0, compute capability: 7.5)
2021-03-22 17:01:53.632174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-03-22 17:01:53.632278: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-03-22 17:01:53.632290: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-03-22 17:01:53.632300: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-03-22 17:01:53.632310: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-03-22 17:01:53.632319: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-03-22 17:01:53.632334: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-03-22 17:01:53.632344: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-03-22 17:01:53.632959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-03-22 17:01:53.633680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-03-22 17:01:53.633728: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-03-22 17:01:53.633739: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-03-22 17:01:53.633748: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-03-22 17:01:53.633757: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-03-22 17:01:53.633766: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-03-22 17:01:53.633775: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-03-22 17:01:53.633784: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-03-22 17:01:53.634358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-03-22 17:01:53.634387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-22 17:01:53.634393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 
2021-03-22 17:01:53.634397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N 
2021-03-22 17:01:53.635004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7184 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 SUPER, pci bus id: 0000:65:00.0, compute capability: 7.5)
2021-03-22 17:02:00.199752: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-03-22 17:02:02.381457: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
Parsing annotation files
idx=1idx=2idx=3idx=4idx=5idx=6idx=7idx=8idx=9idx=10idx=11idx=12
Spend 0.01 mins to load the data
Training images per class:
{'abeille_mellifere': 3,
 'anthophore_plumeuse': 3,
 'bg': 0,
 'boudon_des_arbres': 3,
 'bourdon_des_jardins': 3}
Num classes (including bg) = 5
{'abeille_mellifere': 0, 'boudon_des_arbres': 1, 'anthophore_plumeuse': 2, 'bourdon_des_jardins': 3, 'bg': 4}
Config has been written to ./config/model_small.pickle, and can be loaded when testing to ensure correct results
Num train samples (images) 12
Train set size: 7
Val set size: 2
Test set size: 3
Total dataset size: 12
Loading weights from ./model/vgg16_weights_tf_dim_ordering_tf_kernels.h5
Best loss: inf
=== Validation step code: Validation - param - [0]
Epoch 1/2

1/7 [===>..........................] - ETA: 44s - rpn_cls: 9.3827 - rpn_regr: 0.8593 - final_cls: 1.6094 - final_regr: 0.0000e+00 - loss: 11.8514
2/7 [=======>......................] - ETA: 20s - rpn_cls: 8.7704 - rpn_regr: 0.8561 - final_cls: 1.6021 - final_regr: 0.0719 - loss: 11.3005    
3/7 [===========>..................] - ETA: 11s - rpn_cls: 9.2664 - rpn_regr: 0.7848 - final_cls: 1.5914 - final_regr: 0.1530 - loss: 11.7956
4/7 [================>.............] - ETA: 6s - rpn_cls: 8.9058 - rpn_regr: 0.7213 - final_cls: 1.5749 - final_regr: 0.2149 - loss: 11.4169 
5/7 [====================>.........] - ETA: 3s - rpn_cls: 8.7256 - rpn_regr: 0.6642 - final_cls: 1.5660 - final_regr: 0.2528 - loss: 11.2085
6/7 [========================>.....] - ETA: 1s - rpn_cls: 8.6200 - rpn_regr: 0.6310 - final_cls: 1.5623 - final_regr: 0.2842 - loss: 11.0975
7/7 [==============================] - 11s 2s/step - rpn_cls: 8.4711 - rpn_regr: 0.6024 - final_cls: 1.5585 - final_regr: 0.3101 - loss: 10.9421
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.428571428571429
Classifier accuracy for bounding boxes from RPN: 0.4642857142857143
Loss RPN classifier: 7.5771872741835455
Loss RPN regression: 0.43100681262356894
Loss Detector classifier: 1.5356955868857247
Loss Detector regression: 0.46530171803065706
Total loss: 10.009191391723496
Elapsed time: 10.70754623413086
Start of the validation phase

1/2 [==============>...............] - ETA: 11s - rpn_cls_val: 9.5586 - rpn_regr_val: 0.2103 - final_cls_val: 1.4395 - final_regr_val: 0.2077 - loss_val: 11.4161
2/2 [==============================] - 11s 6s/step - rpn_cls_val: 9.4395 - rpn_regr_val: 0.2034 - final_cls_val: 1.4416 - final_regr_val: 0.2844 - loss_val: 11.3688
2021-03-22 17:02:09.881728: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 411041792 exceeds 10% of free system memory.
2021-03-22 17:02:10.697754: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 67108864 exceeds 10% of free system memory.
End of the validation phase
Validation classifier accuracy for bounding boxes from RPN: 0.5
Validation loss RPN classifier: 9.320433616638184
Validation loss RPN regression: 0.19647571444511414
Validation loss Detector classifier: 1.4436537027359009
Validation loss Detector regression: 0.3610503226518631
Total validation loss: 11.321613356471062
Total validation loss decreased from inf to 11.321613356471062
Epoch 2/2

1/7 [===>..........................] - ETA: 0s - rpn_cls: 9.2908 - rpn_regr: 0.8889 - final_cls: 0.6951 - final_regr: 0.0000e+00 - loss: 10.8749
2/7 [=======>......................] - ETA: 0s - rpn_cls: 9.7625 - rpn_regr: 0.8850 - final_cls: 0.8972 - final_regr: 0.1061 - loss: 11.6507    
3/7 [===========>..................] - ETA: 0s - rpn_cls: 8.7825 - rpn_regr: 0.7987 - final_cls: 1.0028 - final_regr: 0.2095 - loss: 10.7936
4/7 [================>.............] - ETA: 0s - rpn_cls: 8.4137 - rpn_regr: 0.7247 - final_cls: 1.0813 - final_regr: 0.2775 - loss: 10.4972
5/7 [====================>.........] - ETA: 0s - rpn_cls: 8.3363 - rpn_regr: 0.6620 - final_cls: 1.1341 - final_regr: 0.3186 - loss: 10.4510
6/7 [========================>.....] - ETA: 0s - rpn_cls: 8.3747 - rpn_regr: 0.6273 - final_cls: 1.1748 - final_regr: 0.3469 - loss: 10.5237
7/7 [==============================] - 1s 203ms/step - rpn_cls: 8.3577 - rpn_regr: 0.5979 - final_cls: 1.2025 - final_regr: 0.3680 - loss: 10.5261
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.0
Classifier accuracy for bounding boxes from RPN: 0.5714285714285714
Loss RPN classifier: 8.25562960760934
Loss RPN regression: 0.4216876317347799
Loss Detector classifier: 1.3686850666999817
Loss Detector regression: 0.4944912918976375
Total loss: 10.540493597941738
Elapsed time: 1.422349452972412
Start of the validation phase

1/2 [==============>...............] - ETA: 1s - rpn_cls_val: 3.2759 - rpn_regr_val: 0.2590 - final_cls_val: 1.6004 - final_regr_val: 0.7571 - loss_val: 5.8924
2/2 [==============================] - 1s 737ms/step - rpn_cls_val: 5.2710 - rpn_regr_val: 0.2487 - final_cls_val: 1.5417 - final_regr_val: 0.7443 - loss_val: 7.8057
2021-03-22 17:02:17.521331: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 411041792 exceeds 10% of free system memory.
2021-03-22 17:02:18.547634: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 67108864 exceeds 10% of free system memory.
End of the validation phase
Validation classifier accuracy for bounding boxes from RPN: 0.5
Validation loss RPN classifier: 7.26604437828064
Validation loss RPN regression: 0.2384125515818596
Validation loss Detector classifier: 1.4830155968666077
Validation loss Detector regression: 0.7314786911010742
Total validation loss: 9.718951217830181
Total validation loss decreased from 11.321613356471062 to 9.718951217830181
Loading weights from ./model/vgg16_weights_tf_dim_ordering_tf_kernels.h5
Best loss: inf
=== Validation step code: Validation - param - [1]
Epoch 1/2

1/7 [===>..........................] - ETA: 22s - rpn_cls: 6.9579 - rpn_regr: 0.8785 - final_cls: 0.3902 - final_regr: 0.0000e+00 - loss: 8.2266
2/7 [=======>......................] - ETA: 9s - rpn_cls: 7.7094 - rpn_regr: 0.8464 - final_cls: 0.5289 - final_regr: 5.0010e-04 - loss: 9.0853 
3/7 [===========>..................] - ETA: 5s - rpn_cls: 7.0551 - rpn_regr: 0.7704 - final_cls: 0.6495 - final_regr: 0.0776 - loss: 8.5526    
4/7 [================>.............] - ETA: 2s - rpn_cls: 7.0800 - rpn_regr: 0.6998 - final_cls: 0.7457 - final_regr: 0.1392 - loss: 8.6647
5/7 [====================>.........] - ETA: 1s - rpn_cls: 6.8945 - rpn_regr: 0.6410 - final_cls: 0.8197 - final_regr: 0.1939 - loss: 8.5491
6/7 [========================>.....] - ETA: 0s - rpn_cls: 6.8988 - rpn_regr: 0.6124 - final_cls: 0.8776 - final_regr: 0.2381 - loss: 8.6269
7/7 [==============================] - 5s 684ms/step - rpn_cls: 6.9592 - rpn_regr: 0.5855 - final_cls: 0.9210 - final_regr: 0.2746 - loss: 8.7403
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.0
Classifier accuracy for bounding boxes from RPN: 0.6071428571428571
Loss RPN classifier: 7.320990694420678
Loss RPN regression: 0.4241299810154097
Loss Detector classifier: 1.1813157285962785
Loss Detector regression: 0.49410421644071384
Total loss: 9.420540620473082
Elapsed time: 4.7857346534729
Start of the validation phase

1/2 [==============>...............] - ETA: 5s - rpn_cls_val: 7.6147 - rpn_regr_val: 0.2449 - final_cls_val: 1.3858 - final_regr_val: 0.8858 - loss_val: 10.1312
2/2 [==============================] - 5s 3s/step - rpn_cls_val: 9.5044 - rpn_regr_val: 0.2447 - final_cls_val: 1.4006 - final_regr_val: 0.8134 - loss_val: 11.9630
2021-03-22 17:02:32.967499: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 411041792 exceeds 10% of free system memory.
End of the validation phase
Validation classifier accuracy for bounding boxes from RPN: 0.5
Validation loss RPN classifier: 11.393980264663696
Validation loss RPN regression: 0.24442651867866516
Validation loss Detector classifier: 1.4153474569320679
Validation loss Detector regression: 0.7409787476062775
Total validation loss: 13.794732987880707
Total validation loss decreased from inf to 13.794732987880707
Epoch 2/2

1/7 [===>..........................] - ETA: 0s - rpn_cls: 9.9244 - rpn_regr: 0.7388 - final_cls: 0.1185 - final_regr: 0.0000e+00 - loss: 10.7818
2/7 [=======>......................] - ETA: 0s - rpn_cls: 7.8678 - rpn_regr: 0.7628 - final_cls: 0.2295 - final_regr: 0.0000e+00 - loss: 8.8601 
3/7 [===========>..................] - ETA: 0s - rpn_cls: 6.5365 - rpn_regr: 0.7014 - final_cls: 0.3709 - final_regr: 0.0248 - loss: 7.6336    
4/7 [================>.............] - ETA: 0s - rpn_cls: 6.2891 - rpn_regr: 0.6432 - final_cls: 0.4627 - final_regr: 0.0503 - loss: 7.4453
5/7 [====================>.........] - ETA: 0s - rpn_cls: 6.0661 - rpn_regr: 0.5918 - final_cls: 0.5405 - final_regr: 0.0839 - loss: 7.2824
6/7 [========================>.....] - ETA: 0s - rpn_cls: 6.1131 - rpn_regr: 0.5655 - final_cls: 0.6094 - final_regr: 0.1148 - loss: 7.4028
7/7 [==============================] - 1s 154ms/step - rpn_cls: 6.2522 - rpn_regr: 0.5413 - final_cls: 0.6654 - final_regr: 0.1374 - loss: 7.5964
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.0
Classifier accuracy for bounding boxes from RPN: 0.6785714285714286
Loss RPN classifier: 7.086965642157046
Loss RPN regression: 0.39627442029970034
Loss Detector classifier: 1.0012662847127234
Loss Detector regression: 0.27336162115846363
Total loss: 8.757867968327933
Elapsed time: 1.0763068199157715
Start of the validation phase

1/2 [==============>...............] - ETA: 1s - rpn_cls_val: 2.6747 - rpn_regr_val: 0.2103 - final_cls_val: 1.7393 - final_regr_val: 0.5119 - loss_val: 5.1362
2/2 [==============================] - 1s 689ms/step - rpn_cls_val: 3.3712 - rpn_regr_val: 0.2102 - final_cls_val: 1.6637 - final_regr_val: 0.4380 - loss_val: 5.6831
Using TensorFlow backend.
End of the validation phase
Validation classifier accuracy for bounding boxes from RPN: 0.5
Validation loss RPN classifier: 4.067632555961609
Validation loss RPN regression: 0.21022829413414001
Validation loss Detector classifier: 1.588040828704834
Validation loss Detector regression: 0.36409158259630203
Total validation loss: 6.229993261396885
Total validation loss decreased from 13.794732987880707 to 6.229993261396885
=== Best values:
    - param: 1
Training complete, exiting.
